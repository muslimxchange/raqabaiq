{"version":3,"file":"functions.js","mappings":"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","sources":["webpack://excel-custom-functions-js/./src/functions/functions.js"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-unused-vars */\n/* global console setInterval, clearInterval */\n/**\n * Fetches data for a ticker with specific fields.\n * @customfunction TICKER\n * @param {string} ticker\n * @param {string[]} fields\n * @returns {Promise<any[][]>}\n */\nasync function TICKER(ticker, ...fields) {\n  const apiBase = \"https://mxchange-node-p12a3.kinsta.app/api\";\n  const token = await OfficeRuntime.storage.getItem(\"jwt\");\n  \n  if (!token) {\n    return [[\"Login required\"]];\n  }\n  const fieldList = fields.flat().join(\",\");\n\n  const url = `${apiBase}/ticker-data?ticker=${encodeURIComponent(ticker)}&fields=${encodeURIComponent(fieldList)}&token=${encodeURIComponent(token || \"\")}`;\n\n  try {\n    const res = await fetch(url);\n    if (!res.ok) return [[`API Error ${res.status}`]];\n\n    const data = await res.json();\n    const row = [];\n\n    const flatFields = fields.flat();\n    for (let i = 0; i < flatFields.length; i++) {\n      const field = flatFields[i];\n      const value = data[field];\n      const isLast = i === flatFields.length - 1;\n    \n      // Push only if it's not the last OR it's defined\n      if (!isLast || (value !== undefined && value !== null && value !== \"\")) {\n        row.push(value ?? \"Unknown\");\n      }\n    }\n    \n    return [row];\n  } catch {\n    return [[\"Request Failed\"]];\n  }\n}\n\n\n/**\n * Fetches data for a ISIN with specific fields.\n * @customfunction ISIN\n * @param {string} isin\n * @param {string[]} fields\n * @returns {Promise<any[][]>}\n */\nasync function ISIN(ISIN, ...fields) {\n  const apiBase = \"https://mxchange-node-p12a3.kinsta.app/api\";\n  const token = await OfficeRuntime.storage.getItem(\"jwt\");\n  \n  if (!token) {\n    return [[\"Login required\"]];\n  }\n  const fieldList = fields.flat().join(\",\");\n\n  const url = `${apiBase}/isin-data?isin=${encodeURIComponent(ISIN)}&fields=${encodeURIComponent(fieldList)}&token=${encodeURIComponent(token || \"\")}`;\n\n  try {\n    const res = await fetch(url);\n    if (!res.ok) return [[`API Error ${res.status}`]];\n\n    const data = await res.json();\n    const row = [];\n\n    const flatFields = fields.flat();\n    for (let i = 0; i < flatFields.length; i++) {\n      const field = flatFields[i];\n      const value = data[field];\n      const isLast = i === flatFields.length - 1;\n    \n      // Push only if it's not the last OR it's defined\n      if (!isLast || (value !== undefined && value !== null && value !== \"\")) {\n        row.push(value ?? \"Unknown\");\n      }\n    }\n    \n    return [row];\n  } catch {\n    return [[\"Request Failed\"]];\n  }\n}\n\n\nCustomFunctions.associate(\"TICKER\", TICKER);\nCustomFunctions.associate(\"ISIN\", ISIN);"],"names":["e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","enumerable","configurable","writable","_invoke","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_TICKER","_callee","ticker","apiBase","token","_len","fields","_key","fieldList","url","res","data","row","flatFields","field","_args","_context","OfficeRuntime","storage","getItem","Array","flat","join","concat","encodeURIComponent","fetch","ok","status","json","push","_ISIN","_callee2","ISIN","_len2","_key2","_args2","_context2","CustomFunctions","associate","_x","_x2"],"sourceRoot":""}